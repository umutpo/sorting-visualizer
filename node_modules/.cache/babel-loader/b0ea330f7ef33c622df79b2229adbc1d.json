{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Sizing, SplitView } from '../../../../base/browser/ui/splitview/splitview.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { basenameOrAuthority, dirname } from '../../../../base/common/resources.js';\nimport './referencesWidget.css';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions, TextModel } from '../../../common/model/textModel.js';\nimport { ILanguageConfigurationService } from '../../../common/modes/languageConfigurationRegistry.js';\nimport { IModeService } from '../../../common/services/modeService.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { AccessibilityProvider, DataSource, Delegate, FileReferencesRenderer, IdentityProvider, OneReferenceRenderer, StringRepresentationProvider } from './referencesTree.js';\nimport * as peekView from '../../peekView/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { WorkbenchAsyncDataTree } from '../../../../platform/list/browser/listService.js';\nimport { activeContrastBorder } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService, registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { IUndoRedoService } from '../../../../platform/undoRedo/common/undoRedo.js';\nimport { FileReferences, OneReference } from '../referencesModel.js';\n\nclass DecorationsManager {\n  constructor(_editor, _model) {\n    this._editor = _editor;\n    this._model = _model;\n    this._decorations = new Map();\n    this._decorationIgnoreSet = new Set();\n    this._callOnDispose = new DisposableStore();\n    this._callOnModelChange = new DisposableStore();\n\n    this._callOnDispose.add(this._editor.onDidChangeModel(() => this._onModelChanged()));\n\n    this._onModelChanged();\n  }\n\n  dispose() {\n    this._callOnModelChange.dispose();\n\n    this._callOnDispose.dispose();\n\n    this.removeDecorations();\n  }\n\n  _onModelChanged() {\n    this._callOnModelChange.clear();\n\n    const model = this._editor.getModel();\n\n    if (!model) {\n      return;\n    }\n\n    for (let ref of this._model.references) {\n      if (ref.uri.toString() === model.uri.toString()) {\n        this._addDecorations(ref.parent);\n\n        return;\n      }\n    }\n  }\n\n  _addDecorations(reference) {\n    if (!this._editor.hasModel()) {\n      return;\n    }\n\n    this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(() => this._onDecorationChanged()));\n\n    const newDecorations = [];\n    const newDecorationsActualIndex = [];\n\n    for (let i = 0, len = reference.children.length; i < len; i++) {\n      let oneReference = reference.children[i];\n\n      if (this._decorationIgnoreSet.has(oneReference.id)) {\n        continue;\n      }\n\n      if (oneReference.uri.toString() !== this._editor.getModel().uri.toString()) {\n        continue;\n      }\n\n      newDecorations.push({\n        range: oneReference.range,\n        options: DecorationsManager.DecorationOptions\n      });\n      newDecorationsActualIndex.push(i);\n    }\n\n    const decorations = this._editor.deltaDecorations([], newDecorations);\n\n    for (let i = 0; i < decorations.length; i++) {\n      this._decorations.set(decorations[i], reference.children[newDecorationsActualIndex[i]]);\n    }\n  }\n\n  _onDecorationChanged() {\n    const toRemove = [];\n\n    const model = this._editor.getModel();\n\n    if (!model) {\n      return;\n    }\n\n    for (let [decorationId, reference] of this._decorations) {\n      const newRange = model.getDecorationRange(decorationId);\n\n      if (!newRange) {\n        continue;\n      }\n\n      let ignore = false;\n\n      if (Range.equalsRange(newRange, reference.range)) {\n        continue;\n      }\n\n      if (Range.spansMultipleLines(newRange)) {\n        ignore = true;\n      } else {\n        const lineLength = reference.range.endColumn - reference.range.startColumn;\n        const newLineLength = newRange.endColumn - newRange.startColumn;\n\n        if (lineLength !== newLineLength) {\n          ignore = true;\n        }\n      }\n\n      if (ignore) {\n        this._decorationIgnoreSet.add(reference.id);\n\n        toRemove.push(decorationId);\n      } else {\n        reference.range = newRange;\n      }\n    }\n\n    for (let i = 0, len = toRemove.length; i < len; i++) {\n      this._decorations.delete(toRemove[i]);\n    }\n\n    this._editor.deltaDecorations(toRemove, []);\n  }\n\n  removeDecorations() {\n    this._editor.deltaDecorations([...this._decorations.keys()], []);\n\n    this._decorations.clear();\n  }\n\n}\n\nDecorationsManager.DecorationOptions = ModelDecorationOptions.register({\n  description: 'reference-decoration',\n  stickiness: 1\n  /* NeverGrowsWhenTypingAtEdges */\n  ,\n  className: 'reference-decoration'\n});\nexport class LayoutData {\n  constructor() {\n    this.ratio = 0.7;\n    this.heightInLines = 18;\n  }\n\n  static fromJSON(raw) {\n    let ratio;\n    let heightInLines;\n\n    try {\n      const data = JSON.parse(raw);\n      ratio = data.ratio;\n      heightInLines = data.heightInLines;\n    } catch (_a) {//\n    }\n\n    return {\n      ratio: ratio || 0.7,\n      heightInLines: heightInLines || 18\n    };\n  }\n\n}\n\nclass ReferencesTree extends WorkbenchAsyncDataTree {}\n/**\n * ZoneWidget that is shown inside the editor\n */\n\n\nlet ReferenceWidget = class ReferenceWidget extends peekView.PeekViewWidget {\n  constructor(editor, _defaultTreeKeyboardSupport, layoutData, themeService, _textModelResolverService, _instantiationService, _peekViewService, _uriLabel, _undoRedoService, _keybindingService, _modeService, _languageConfigurationService) {\n    super(editor, {\n      showFrame: false,\n      showArrow: true,\n      isResizeable: true,\n      isAccessible: true,\n      supportOnTitleClick: true\n    }, _instantiationService);\n    this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n    this.layoutData = layoutData;\n    this._textModelResolverService = _textModelResolverService;\n    this._instantiationService = _instantiationService;\n    this._peekViewService = _peekViewService;\n    this._uriLabel = _uriLabel;\n    this._undoRedoService = _undoRedoService;\n    this._keybindingService = _keybindingService;\n    this._modeService = _modeService;\n    this._languageConfigurationService = _languageConfigurationService;\n    this._disposeOnNewModel = new DisposableStore();\n    this._callOnDispose = new DisposableStore();\n    this._onDidSelectReference = new Emitter();\n    this.onDidSelectReference = this._onDidSelectReference.event;\n    this._dim = new dom.Dimension(0, 0);\n\n    this._applyTheme(themeService.getColorTheme());\n\n    this._callOnDispose.add(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n\n    this._peekViewService.addExclusiveWidget(editor, this);\n\n    this.create();\n  }\n\n  dispose() {\n    this.setModel(undefined);\n\n    this._callOnDispose.dispose();\n\n    this._disposeOnNewModel.dispose();\n\n    dispose(this._preview);\n    dispose(this._previewNotAvailableMessage);\n    dispose(this._tree);\n    dispose(this._previewModelReference);\n\n    this._splitView.dispose();\n\n    super.dispose();\n  }\n\n  _applyTheme(theme) {\n    const borderColor = theme.getColor(peekView.peekViewBorder) || Color.transparent;\n    this.style({\n      arrowColor: borderColor,\n      frameColor: borderColor,\n      headerBackgroundColor: theme.getColor(peekView.peekViewTitleBackground) || Color.transparent,\n      primaryHeadingColor: theme.getColor(peekView.peekViewTitleForeground),\n      secondaryHeadingColor: theme.getColor(peekView.peekViewTitleInfoForeground)\n    });\n  }\n\n  show(where) {\n    this.editor.revealRangeInCenterIfOutsideViewport(where, 0\n    /* Smooth */\n    );\n    super.show(where, this.layoutData.heightInLines || 18);\n  }\n\n  focusOnReferenceTree() {\n    this._tree.domFocus();\n  }\n\n  focusOnPreviewEditor() {\n    this._preview.focus();\n  }\n\n  isPreviewEditorFocused() {\n    return this._preview.hasTextFocus();\n  }\n\n  _onTitleClick(e) {\n    if (this._preview && this._preview.getModel()) {\n      this._onDidSelectReference.fire({\n        element: this._getFocusedReference(),\n        kind: e.ctrlKey || e.metaKey || e.altKey ? 'side' : 'open',\n        source: 'title'\n      });\n    }\n  }\n\n  _fillBody(containerElement) {\n    this.setCssClass('reference-zone-widget'); // message pane\n\n    this._messageContainer = dom.append(containerElement, dom.$('div.messages'));\n    dom.hide(this._messageContainer);\n    this._splitView = new SplitView(containerElement, {\n      orientation: 1\n      /* HORIZONTAL */\n\n    }); // editor\n\n    this._previewContainer = dom.append(containerElement, dom.$('div.preview.inline'));\n    let options = {\n      scrollBeyondLastLine: false,\n      scrollbar: {\n        verticalScrollbarSize: 14,\n        horizontal: 'auto',\n        useShadows: true,\n        verticalHasArrows: false,\n        horizontalHasArrows: false,\n        alwaysConsumeMouseWheel: false\n      },\n      overviewRulerLanes: 2,\n      fixedOverflowWidgets: true,\n      minimap: {\n        enabled: false\n      }\n    };\n    this._preview = this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._previewContainer, options, this.editor);\n    dom.hide(this._previewContainer);\n    this._previewNotAvailableMessage = new TextModel(nls.localize('missingPreviewMessage', \"no preview available\"), TextModel.DEFAULT_CREATION_OPTIONS, null, null, this._undoRedoService, this._modeService, this._languageConfigurationService); // tree\n\n    this._treeContainer = dom.append(containerElement, dom.$('div.ref-tree.inline'));\n    const treeOptions = {\n      keyboardSupport: this._defaultTreeKeyboardSupport,\n      accessibilityProvider: new AccessibilityProvider(),\n      keyboardNavigationLabelProvider: this._instantiationService.createInstance(StringRepresentationProvider),\n      identityProvider: new IdentityProvider(),\n      openOnSingleClick: true,\n      selectionNavigation: true,\n      overrideStyles: {\n        listBackground: peekView.peekViewResultsBackground\n      }\n    };\n\n    if (this._defaultTreeKeyboardSupport) {\n      // the tree will consume `Escape` and prevent the widget from closing\n      this._callOnDispose.add(dom.addStandardDisposableListener(this._treeContainer, 'keydown', e => {\n        if (e.equals(9\n        /* Escape */\n        )) {\n          this._keybindingService.dispatchEvent(e, e.target);\n\n          e.stopPropagation();\n        }\n      }, true));\n    }\n\n    this._tree = this._instantiationService.createInstance(ReferencesTree, 'ReferencesWidget', this._treeContainer, new Delegate(), [this._instantiationService.createInstance(FileReferencesRenderer), this._instantiationService.createInstance(OneReferenceRenderer)], this._instantiationService.createInstance(DataSource), treeOptions); // split stuff\n\n    this._splitView.addView({\n      onDidChange: Event.None,\n      element: this._previewContainer,\n      minimumSize: 200,\n      maximumSize: Number.MAX_VALUE,\n      layout: width => {\n        this._preview.layout({\n          height: this._dim.height,\n          width\n        });\n      }\n    }, Sizing.Distribute);\n\n    this._splitView.addView({\n      onDidChange: Event.None,\n      element: this._treeContainer,\n      minimumSize: 100,\n      maximumSize: Number.MAX_VALUE,\n      layout: width => {\n        this._treeContainer.style.height = `${this._dim.height}px`;\n        this._treeContainer.style.width = `${width}px`;\n\n        this._tree.layout(this._dim.height, width);\n      }\n    }, Sizing.Distribute);\n\n    this._disposables.add(this._splitView.onDidSashChange(() => {\n      if (this._dim.width) {\n        this.layoutData.ratio = this._splitView.getViewSize(0) / this._dim.width;\n      }\n    }, undefined)); // listen on selection and focus\n\n\n    let onEvent = (element, kind) => {\n      if (element instanceof OneReference) {\n        if (kind === 'show') {\n          this._revealReference(element, false);\n        }\n\n        this._onDidSelectReference.fire({\n          element,\n          kind,\n          source: 'tree'\n        });\n      }\n    };\n\n    this._tree.onDidOpen(e => {\n      if (e.sideBySide) {\n        onEvent(e.element, 'side');\n      } else if (e.editorOptions.pinned) {\n        onEvent(e.element, 'goto');\n      } else {\n        onEvent(e.element, 'show');\n      }\n    });\n\n    dom.hide(this._treeContainer);\n  }\n\n  _onWidth(width) {\n    if (this._dim) {\n      this._doLayoutBody(this._dim.height, width);\n    }\n  }\n\n  _doLayoutBody(heightInPixel, widthInPixel) {\n    super._doLayoutBody(heightInPixel, widthInPixel);\n\n    this._dim = new dom.Dimension(widthInPixel, heightInPixel);\n    this.layoutData.heightInLines = this._viewZone ? this._viewZone.heightInLines : this.layoutData.heightInLines;\n\n    this._splitView.layout(widthInPixel);\n\n    this._splitView.resizeView(0, widthInPixel * this.layoutData.ratio);\n  }\n\n  setSelection(selection) {\n    return this._revealReference(selection, true).then(() => {\n      if (!this._model) {\n        // disposed\n        return;\n      } // show in tree\n\n\n      this._tree.setSelection([selection]);\n\n      this._tree.setFocus([selection]);\n    });\n  }\n\n  setModel(newModel) {\n    // clean up\n    this._disposeOnNewModel.clear();\n\n    this._model = newModel;\n\n    if (this._model) {\n      return this._onNewModel();\n    }\n\n    return Promise.resolve();\n  }\n\n  _onNewModel() {\n    if (!this._model) {\n      return Promise.resolve(undefined);\n    }\n\n    if (this._model.isEmpty) {\n      this.setTitle('');\n      this._messageContainer.innerText = nls.localize('noResults', \"No results\");\n      dom.show(this._messageContainer);\n      return Promise.resolve(undefined);\n    }\n\n    dom.hide(this._messageContainer);\n    this._decorationsManager = new DecorationsManager(this._preview, this._model);\n\n    this._disposeOnNewModel.add(this._decorationsManager); // listen on model changes\n\n\n    this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(reference => this._tree.rerender(reference))); // listen on editor\n\n\n    this._disposeOnNewModel.add(this._preview.onMouseDown(e => {\n      const {\n        event,\n        target\n      } = e;\n\n      if (event.detail !== 2) {\n        return;\n      }\n\n      const element = this._getFocusedReference();\n\n      if (!element) {\n        return;\n      }\n\n      this._onDidSelectReference.fire({\n        element: {\n          uri: element.uri,\n          range: target.range\n        },\n        kind: event.ctrlKey || event.metaKey || event.altKey ? 'side' : 'open',\n        source: 'editor'\n      });\n    })); // make sure things are rendered\n\n\n    this.container.classList.add('results-loaded');\n    dom.show(this._treeContainer);\n    dom.show(this._previewContainer);\n\n    this._splitView.layout(this._dim.width);\n\n    this.focusOnReferenceTree(); // pick input and a reference to begin with\n\n    return this._tree.setInput(this._model.groups.length === 1 ? this._model.groups[0] : this._model);\n  }\n\n  _getFocusedReference() {\n    const [element] = this._tree.getFocus();\n\n    if (element instanceof OneReference) {\n      return element;\n    } else if (element instanceof FileReferences) {\n      if (element.children.length > 0) {\n        return element.children[0];\n      }\n    }\n\n    return undefined;\n  }\n\n  revealReference(reference) {\n    return __awaiter(this, void 0, void 0, function* () {\n      yield this._revealReference(reference, false);\n\n      this._onDidSelectReference.fire({\n        element: reference,\n        kind: 'goto',\n        source: 'tree'\n      });\n    });\n  }\n\n  _revealReference(reference, revealParent) {\n    return __awaiter(this, void 0, void 0, function* () {\n      // check if there is anything to do...\n      if (this._revealedReference === reference) {\n        return;\n      }\n\n      this._revealedReference = reference; // Update widget header\n\n      if (reference.uri.scheme !== Schemas.inMemory) {\n        this.setTitle(basenameOrAuthority(reference.uri), this._uriLabel.getUriLabel(dirname(reference.uri)));\n      } else {\n        this.setTitle(nls.localize('peekView.alternateTitle', \"References\"));\n      }\n\n      const promise = this._textModelResolverService.createModelReference(reference.uri);\n\n      if (this._tree.getInput() === reference.parent) {\n        this._tree.reveal(reference);\n      } else {\n        if (revealParent) {\n          this._tree.reveal(reference.parent);\n        }\n\n        yield this._tree.expand(reference.parent);\n\n        this._tree.reveal(reference);\n      }\n\n      const ref = yield promise;\n\n      if (!this._model) {\n        // disposed\n        ref.dispose();\n        return;\n      }\n\n      dispose(this._previewModelReference); // show in editor\n\n      const model = ref.object;\n\n      if (model) {\n        const scrollType = this._preview.getModel() === model.textEditorModel ? 0\n        /* Smooth */\n        : 1\n        /* Immediate */\n        ;\n        const sel = Range.lift(reference.range).collapseToStart();\n        this._previewModelReference = ref;\n\n        this._preview.setModel(model.textEditorModel);\n\n        this._preview.setSelection(sel);\n\n        this._preview.revealRangeInCenter(sel, scrollType);\n      } else {\n        this._preview.setModel(this._previewNotAvailableMessage);\n\n        ref.dispose();\n      }\n    });\n  }\n\n};\nReferenceWidget = __decorate([__param(3, IThemeService), __param(4, ITextModelService), __param(5, IInstantiationService), __param(6, peekView.IPeekViewService), __param(7, ILabelService), __param(8, IUndoRedoService), __param(9, IKeybindingService), __param(10, IModeService), __param(11, ILanguageConfigurationService)], ReferenceWidget);\nexport { ReferenceWidget }; // theming\n\nregisterThemingParticipant((theme, collector) => {\n  const findMatchHighlightColor = theme.getColor(peekView.peekViewResultsMatchHighlight);\n\n  if (findMatchHighlightColor) {\n    collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { background-color: ${findMatchHighlightColor}; }`);\n  }\n\n  const referenceHighlightColor = theme.getColor(peekView.peekViewEditorMatchHighlight);\n\n  if (referenceHighlightColor) {\n    collector.addRule(`.monaco-editor .reference-zone-widget .preview .reference-decoration { background-color: ${referenceHighlightColor}; }`);\n  }\n\n  const referenceHighlightBorder = theme.getColor(peekView.peekViewEditorMatchHighlightBorder);\n\n  if (referenceHighlightBorder) {\n    collector.addRule(`.monaco-editor .reference-zone-widget .preview .reference-decoration { border: 2px solid ${referenceHighlightBorder}; box-sizing: border-box; }`);\n  }\n\n  const hcOutline = theme.getColor(activeContrastBorder);\n\n  if (hcOutline) {\n    collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { border: 1px dotted ${hcOutline}; box-sizing: border-box; }`);\n  }\n\n  const resultsBackground = theme.getColor(peekView.peekViewResultsBackground);\n\n  if (resultsBackground) {\n    collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree { background-color: ${resultsBackground}; }`);\n  }\n\n  const resultsMatchForeground = theme.getColor(peekView.peekViewResultsMatchForeground);\n\n  if (resultsMatchForeground) {\n    collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree { color: ${resultsMatchForeground}; }`);\n  }\n\n  const resultsFileForeground = theme.getColor(peekView.peekViewResultsFileForeground);\n\n  if (resultsFileForeground) {\n    collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .reference-file { color: ${resultsFileForeground}; }`);\n  }\n\n  const resultsSelectedBackground = theme.getColor(peekView.peekViewResultsSelectionBackground);\n\n  if (resultsSelectedBackground) {\n    collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { background-color: ${resultsSelectedBackground}; }`);\n  }\n\n  const resultsSelectedForeground = theme.getColor(peekView.peekViewResultsSelectionForeground);\n\n  if (resultsSelectedForeground) {\n    collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { color: ${resultsSelectedForeground} !important; }`);\n  }\n\n  const editorBackground = theme.getColor(peekView.peekViewEditorBackground);\n\n  if (editorBackground) {\n    collector.addRule(`.monaco-editor .reference-zone-widget .preview .monaco-editor .monaco-editor-background,` + `.monaco-editor .reference-zone-widget .preview .monaco-editor .inputarea.ime-input {` + `\tbackground-color: ${editorBackground};` + `}`);\n  }\n\n  const editorGutterBackground = theme.getColor(peekView.peekViewEditorGutterBackground);\n\n  if (editorGutterBackground) {\n    collector.addRule(`.monaco-editor .reference-zone-widget .preview .monaco-editor .margin {` + `\tbackground-color: ${editorGutterBackground};` + `}`);\n  }\n});","map":{"version":3,"sources":["/home/umut/Documents/cs/cs410/Project2Group14/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/peek/referencesWidget.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","dom","Sizing","SplitView","Color","Emitter","Event","DisposableStore","dispose","Schemas","basenameOrAuthority","dirname","EmbeddedCodeEditorWidget","Range","ModelDecorationOptions","TextModel","ILanguageConfigurationService","IModeService","ITextModelService","AccessibilityProvider","DataSource","Delegate","FileReferencesRenderer","IdentityProvider","OneReferenceRenderer","StringRepresentationProvider","peekView","nls","IInstantiationService","IKeybindingService","ILabelService","WorkbenchAsyncDataTree","activeContrastBorder","IThemeService","registerThemingParticipant","IUndoRedoService","FileReferences","OneReference","DecorationsManager","constructor","_editor","_model","_decorations","Map","_decorationIgnoreSet","Set","_callOnDispose","_callOnModelChange","add","onDidChangeModel","_onModelChanged","removeDecorations","clear","model","getModel","ref","references","uri","toString","_addDecorations","parent","reference","hasModel","onDidChangeDecorations","_onDecorationChanged","newDecorations","newDecorationsActualIndex","len","children","oneReference","has","id","push","range","options","DecorationOptions","decorations","deltaDecorations","set","toRemove","decorationId","newRange","getDecorationRange","ignore","equalsRange","spansMultipleLines","lineLength","endColumn","startColumn","newLineLength","delete","keys","register","description","stickiness","className","LayoutData","ratio","heightInLines","fromJSON","raw","data","JSON","parse","_a","ReferencesTree","ReferenceWidget","PeekViewWidget","editor","_defaultTreeKeyboardSupport","layoutData","themeService","_textModelResolverService","_instantiationService","_peekViewService","_uriLabel","_undoRedoService","_keybindingService","_modeService","_languageConfigurationService","showFrame","showArrow","isResizeable","isAccessible","supportOnTitleClick","_disposeOnNewModel","_onDidSelectReference","onDidSelectReference","event","_dim","Dimension","_applyTheme","getColorTheme","onDidColorThemeChange","bind","addExclusiveWidget","create","setModel","undefined","_preview","_previewNotAvailableMessage","_tree","_previewModelReference","_splitView","theme","borderColor","getColor","peekViewBorder","transparent","style","arrowColor","frameColor","headerBackgroundColor","peekViewTitleBackground","primaryHeadingColor","peekViewTitleForeground","secondaryHeadingColor","peekViewTitleInfoForeground","show","where","revealRangeInCenterIfOutsideViewport","focusOnReferenceTree","domFocus","focusOnPreviewEditor","focus","isPreviewEditorFocused","hasTextFocus","_onTitleClick","fire","element","_getFocusedReference","kind","ctrlKey","metaKey","altKey","source","_fillBody","containerElement","setCssClass","_messageContainer","append","$","hide","orientation","_previewContainer","scrollBeyondLastLine","scrollbar","verticalScrollbarSize","horizontal","useShadows","verticalHasArrows","horizontalHasArrows","alwaysConsumeMouseWheel","overviewRulerLanes","fixedOverflowWidgets","minimap","enabled","createInstance","localize","DEFAULT_CREATION_OPTIONS","_treeContainer","treeOptions","keyboardSupport","accessibilityProvider","keyboardNavigationLabelProvider","identityProvider","openOnSingleClick","selectionNavigation","overrideStyles","listBackground","peekViewResultsBackground","addStandardDisposableListener","equals","dispatchEvent","stopPropagation","addView","onDidChange","None","minimumSize","maximumSize","Number","MAX_VALUE","layout","width","height","Distribute","_disposables","onDidSashChange","getViewSize","onEvent","_revealReference","onDidOpen","sideBySide","editorOptions","pinned","_onWidth","_doLayoutBody","heightInPixel","widthInPixel","_viewZone","resizeView","setSelection","selection","setFocus","newModel","_onNewModel","isEmpty","setTitle","innerText","_decorationsManager","onDidChangeReferenceRange","rerender","onMouseDown","detail","container","classList","setInput","groups","getFocus","revealReference","revealParent","_revealedReference","scheme","inMemory","getUriLabel","promise","createModelReference","getInput","reveal","expand","object","scrollType","textEditorModel","sel","lift","collapseToStart","revealRangeInCenter","IPeekViewService","collector","findMatchHighlightColor","peekViewResultsMatchHighlight","addRule","referenceHighlightColor","peekViewEditorMatchHighlight","referenceHighlightBorder","peekViewEditorMatchHighlightBorder","hcOutline","resultsBackground","resultsMatchForeground","peekViewResultsMatchForeground","resultsFileForeground","peekViewResultsFileForeground","resultsSelectedBackground","peekViewResultsSelectionBackground","resultsSelectedForeground","peekViewResultsSelectionForeground","editorBackground","peekViewEditorBackground","editorGutterBackground","peekViewEditorGutterBackground"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Sizing, SplitView } from '../../../../base/browser/ui/splitview/splitview.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { basenameOrAuthority, dirname } from '../../../../base/common/resources.js';\nimport './referencesWidget.css';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions, TextModel } from '../../../common/model/textModel.js';\nimport { ILanguageConfigurationService } from '../../../common/modes/languageConfigurationRegistry.js';\nimport { IModeService } from '../../../common/services/modeService.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { AccessibilityProvider, DataSource, Delegate, FileReferencesRenderer, IdentityProvider, OneReferenceRenderer, StringRepresentationProvider } from './referencesTree.js';\nimport * as peekView from '../../peekView/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { WorkbenchAsyncDataTree } from '../../../../platform/list/browser/listService.js';\nimport { activeContrastBorder } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService, registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { IUndoRedoService } from '../../../../platform/undoRedo/common/undoRedo.js';\nimport { FileReferences, OneReference } from '../referencesModel.js';\nclass DecorationsManager {\n    constructor(_editor, _model) {\n        this._editor = _editor;\n        this._model = _model;\n        this._decorations = new Map();\n        this._decorationIgnoreSet = new Set();\n        this._callOnDispose = new DisposableStore();\n        this._callOnModelChange = new DisposableStore();\n        this._callOnDispose.add(this._editor.onDidChangeModel(() => this._onModelChanged()));\n        this._onModelChanged();\n    }\n    dispose() {\n        this._callOnModelChange.dispose();\n        this._callOnDispose.dispose();\n        this.removeDecorations();\n    }\n    _onModelChanged() {\n        this._callOnModelChange.clear();\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (let ref of this._model.references) {\n            if (ref.uri.toString() === model.uri.toString()) {\n                this._addDecorations(ref.parent);\n                return;\n            }\n        }\n    }\n    _addDecorations(reference) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(() => this._onDecorationChanged()));\n        const newDecorations = [];\n        const newDecorationsActualIndex = [];\n        for (let i = 0, len = reference.children.length; i < len; i++) {\n            let oneReference = reference.children[i];\n            if (this._decorationIgnoreSet.has(oneReference.id)) {\n                continue;\n            }\n            if (oneReference.uri.toString() !== this._editor.getModel().uri.toString()) {\n                continue;\n            }\n            newDecorations.push({\n                range: oneReference.range,\n                options: DecorationsManager.DecorationOptions\n            });\n            newDecorationsActualIndex.push(i);\n        }\n        const decorations = this._editor.deltaDecorations([], newDecorations);\n        for (let i = 0; i < decorations.length; i++) {\n            this._decorations.set(decorations[i], reference.children[newDecorationsActualIndex[i]]);\n        }\n    }\n    _onDecorationChanged() {\n        const toRemove = [];\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (let [decorationId, reference] of this._decorations) {\n            const newRange = model.getDecorationRange(decorationId);\n            if (!newRange) {\n                continue;\n            }\n            let ignore = false;\n            if (Range.equalsRange(newRange, reference.range)) {\n                continue;\n            }\n            if (Range.spansMultipleLines(newRange)) {\n                ignore = true;\n            }\n            else {\n                const lineLength = reference.range.endColumn - reference.range.startColumn;\n                const newLineLength = newRange.endColumn - newRange.startColumn;\n                if (lineLength !== newLineLength) {\n                    ignore = true;\n                }\n            }\n            if (ignore) {\n                this._decorationIgnoreSet.add(reference.id);\n                toRemove.push(decorationId);\n            }\n            else {\n                reference.range = newRange;\n            }\n        }\n        for (let i = 0, len = toRemove.length; i < len; i++) {\n            this._decorations.delete(toRemove[i]);\n        }\n        this._editor.deltaDecorations(toRemove, []);\n    }\n    removeDecorations() {\n        this._editor.deltaDecorations([...this._decorations.keys()], []);\n        this._decorations.clear();\n    }\n}\nDecorationsManager.DecorationOptions = ModelDecorationOptions.register({\n    description: 'reference-decoration',\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\n    className: 'reference-decoration'\n});\nexport class LayoutData {\n    constructor() {\n        this.ratio = 0.7;\n        this.heightInLines = 18;\n    }\n    static fromJSON(raw) {\n        let ratio;\n        let heightInLines;\n        try {\n            const data = JSON.parse(raw);\n            ratio = data.ratio;\n            heightInLines = data.heightInLines;\n        }\n        catch (_a) {\n            //\n        }\n        return {\n            ratio: ratio || 0.7,\n            heightInLines: heightInLines || 18\n        };\n    }\n}\nclass ReferencesTree extends WorkbenchAsyncDataTree {\n}\n/**\n * ZoneWidget that is shown inside the editor\n */\nlet ReferenceWidget = class ReferenceWidget extends peekView.PeekViewWidget {\n    constructor(editor, _defaultTreeKeyboardSupport, layoutData, themeService, _textModelResolverService, _instantiationService, _peekViewService, _uriLabel, _undoRedoService, _keybindingService, _modeService, _languageConfigurationService) {\n        super(editor, { showFrame: false, showArrow: true, isResizeable: true, isAccessible: true, supportOnTitleClick: true }, _instantiationService);\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this.layoutData = layoutData;\n        this._textModelResolverService = _textModelResolverService;\n        this._instantiationService = _instantiationService;\n        this._peekViewService = _peekViewService;\n        this._uriLabel = _uriLabel;\n        this._undoRedoService = _undoRedoService;\n        this._keybindingService = _keybindingService;\n        this._modeService = _modeService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._disposeOnNewModel = new DisposableStore();\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectReference = new Emitter();\n        this.onDidSelectReference = this._onDidSelectReference.event;\n        this._dim = new dom.Dimension(0, 0);\n        this._applyTheme(themeService.getColorTheme());\n        this._callOnDispose.add(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this._peekViewService.addExclusiveWidget(editor, this);\n        this.create();\n    }\n    dispose() {\n        this.setModel(undefined);\n        this._callOnDispose.dispose();\n        this._disposeOnNewModel.dispose();\n        dispose(this._preview);\n        dispose(this._previewNotAvailableMessage);\n        dispose(this._tree);\n        dispose(this._previewModelReference);\n        this._splitView.dispose();\n        super.dispose();\n    }\n    _applyTheme(theme) {\n        const borderColor = theme.getColor(peekView.peekViewBorder) || Color.transparent;\n        this.style({\n            arrowColor: borderColor,\n            frameColor: borderColor,\n            headerBackgroundColor: theme.getColor(peekView.peekViewTitleBackground) || Color.transparent,\n            primaryHeadingColor: theme.getColor(peekView.peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekView.peekViewTitleInfoForeground)\n        });\n    }\n    show(where) {\n        this.editor.revealRangeInCenterIfOutsideViewport(where, 0 /* Smooth */);\n        super.show(where, this.layoutData.heightInLines || 18);\n    }\n    focusOnReferenceTree() {\n        this._tree.domFocus();\n    }\n    focusOnPreviewEditor() {\n        this._preview.focus();\n    }\n    isPreviewEditorFocused() {\n        return this._preview.hasTextFocus();\n    }\n    _onTitleClick(e) {\n        if (this._preview && this._preview.getModel()) {\n            this._onDidSelectReference.fire({\n                element: this._getFocusedReference(),\n                kind: e.ctrlKey || e.metaKey || e.altKey ? 'side' : 'open',\n                source: 'title'\n            });\n        }\n    }\n    _fillBody(containerElement) {\n        this.setCssClass('reference-zone-widget');\n        // message pane\n        this._messageContainer = dom.append(containerElement, dom.$('div.messages'));\n        dom.hide(this._messageContainer);\n        this._splitView = new SplitView(containerElement, { orientation: 1 /* HORIZONTAL */ });\n        // editor\n        this._previewContainer = dom.append(containerElement, dom.$('div.preview.inline'));\n        let options = {\n            scrollBeyondLastLine: false,\n            scrollbar: {\n                verticalScrollbarSize: 14,\n                horizontal: 'auto',\n                useShadows: true,\n                verticalHasArrows: false,\n                horizontalHasArrows: false,\n                alwaysConsumeMouseWheel: false\n            },\n            overviewRulerLanes: 2,\n            fixedOverflowWidgets: true,\n            minimap: {\n                enabled: false\n            }\n        };\n        this._preview = this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._previewContainer, options, this.editor);\n        dom.hide(this._previewContainer);\n        this._previewNotAvailableMessage = new TextModel(nls.localize('missingPreviewMessage', \"no preview available\"), TextModel.DEFAULT_CREATION_OPTIONS, null, null, this._undoRedoService, this._modeService, this._languageConfigurationService);\n        // tree\n        this._treeContainer = dom.append(containerElement, dom.$('div.ref-tree.inline'));\n        const treeOptions = {\n            keyboardSupport: this._defaultTreeKeyboardSupport,\n            accessibilityProvider: new AccessibilityProvider(),\n            keyboardNavigationLabelProvider: this._instantiationService.createInstance(StringRepresentationProvider),\n            identityProvider: new IdentityProvider(),\n            openOnSingleClick: true,\n            selectionNavigation: true,\n            overrideStyles: {\n                listBackground: peekView.peekViewResultsBackground\n            }\n        };\n        if (this._defaultTreeKeyboardSupport) {\n            // the tree will consume `Escape` and prevent the widget from closing\n            this._callOnDispose.add(dom.addStandardDisposableListener(this._treeContainer, 'keydown', (e) => {\n                if (e.equals(9 /* Escape */)) {\n                    this._keybindingService.dispatchEvent(e, e.target);\n                    e.stopPropagation();\n                }\n            }, true));\n        }\n        this._tree = this._instantiationService.createInstance(ReferencesTree, 'ReferencesWidget', this._treeContainer, new Delegate(), [\n            this._instantiationService.createInstance(FileReferencesRenderer),\n            this._instantiationService.createInstance(OneReferenceRenderer),\n        ], this._instantiationService.createInstance(DataSource), treeOptions);\n        // split stuff\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._previewContainer,\n            minimumSize: 200,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._preview.layout({ height: this._dim.height, width });\n            }\n        }, Sizing.Distribute);\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._treeContainer,\n            minimumSize: 100,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._treeContainer.style.height = `${this._dim.height}px`;\n                this._treeContainer.style.width = `${width}px`;\n                this._tree.layout(this._dim.height, width);\n            }\n        }, Sizing.Distribute);\n        this._disposables.add(this._splitView.onDidSashChange(() => {\n            if (this._dim.width) {\n                this.layoutData.ratio = this._splitView.getViewSize(0) / this._dim.width;\n            }\n        }, undefined));\n        // listen on selection and focus\n        let onEvent = (element, kind) => {\n            if (element instanceof OneReference) {\n                if (kind === 'show') {\n                    this._revealReference(element, false);\n                }\n                this._onDidSelectReference.fire({ element, kind, source: 'tree' });\n            }\n        };\n        this._tree.onDidOpen(e => {\n            if (e.sideBySide) {\n                onEvent(e.element, 'side');\n            }\n            else if (e.editorOptions.pinned) {\n                onEvent(e.element, 'goto');\n            }\n            else {\n                onEvent(e.element, 'show');\n            }\n        });\n        dom.hide(this._treeContainer);\n    }\n    _onWidth(width) {\n        if (this._dim) {\n            this._doLayoutBody(this._dim.height, width);\n        }\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._dim = new dom.Dimension(widthInPixel, heightInPixel);\n        this.layoutData.heightInLines = this._viewZone ? this._viewZone.heightInLines : this.layoutData.heightInLines;\n        this._splitView.layout(widthInPixel);\n        this._splitView.resizeView(0, widthInPixel * this.layoutData.ratio);\n    }\n    setSelection(selection) {\n        return this._revealReference(selection, true).then(() => {\n            if (!this._model) {\n                // disposed\n                return;\n            }\n            // show in tree\n            this._tree.setSelection([selection]);\n            this._tree.setFocus([selection]);\n        });\n    }\n    setModel(newModel) {\n        // clean up\n        this._disposeOnNewModel.clear();\n        this._model = newModel;\n        if (this._model) {\n            return this._onNewModel();\n        }\n        return Promise.resolve();\n    }\n    _onNewModel() {\n        if (!this._model) {\n            return Promise.resolve(undefined);\n        }\n        if (this._model.isEmpty) {\n            this.setTitle('');\n            this._messageContainer.innerText = nls.localize('noResults', \"No results\");\n            dom.show(this._messageContainer);\n            return Promise.resolve(undefined);\n        }\n        dom.hide(this._messageContainer);\n        this._decorationsManager = new DecorationsManager(this._preview, this._model);\n        this._disposeOnNewModel.add(this._decorationsManager);\n        // listen on model changes\n        this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(reference => this._tree.rerender(reference)));\n        // listen on editor\n        this._disposeOnNewModel.add(this._preview.onMouseDown(e => {\n            const { event, target } = e;\n            if (event.detail !== 2) {\n                return;\n            }\n            const element = this._getFocusedReference();\n            if (!element) {\n                return;\n            }\n            this._onDidSelectReference.fire({\n                element: { uri: element.uri, range: target.range },\n                kind: (event.ctrlKey || event.metaKey || event.altKey) ? 'side' : 'open',\n                source: 'editor'\n            });\n        }));\n        // make sure things are rendered\n        this.container.classList.add('results-loaded');\n        dom.show(this._treeContainer);\n        dom.show(this._previewContainer);\n        this._splitView.layout(this._dim.width);\n        this.focusOnReferenceTree();\n        // pick input and a reference to begin with\n        return this._tree.setInput(this._model.groups.length === 1 ? this._model.groups[0] : this._model);\n    }\n    _getFocusedReference() {\n        const [element] = this._tree.getFocus();\n        if (element instanceof OneReference) {\n            return element;\n        }\n        else if (element instanceof FileReferences) {\n            if (element.children.length > 0) {\n                return element.children[0];\n            }\n        }\n        return undefined;\n    }\n    revealReference(reference) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._revealReference(reference, false);\n            this._onDidSelectReference.fire({ element: reference, kind: 'goto', source: 'tree' });\n        });\n    }\n    _revealReference(reference, revealParent) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // check if there is anything to do...\n            if (this._revealedReference === reference) {\n                return;\n            }\n            this._revealedReference = reference;\n            // Update widget header\n            if (reference.uri.scheme !== Schemas.inMemory) {\n                this.setTitle(basenameOrAuthority(reference.uri), this._uriLabel.getUriLabel(dirname(reference.uri)));\n            }\n            else {\n                this.setTitle(nls.localize('peekView.alternateTitle', \"References\"));\n            }\n            const promise = this._textModelResolverService.createModelReference(reference.uri);\n            if (this._tree.getInput() === reference.parent) {\n                this._tree.reveal(reference);\n            }\n            else {\n                if (revealParent) {\n                    this._tree.reveal(reference.parent);\n                }\n                yield this._tree.expand(reference.parent);\n                this._tree.reveal(reference);\n            }\n            const ref = yield promise;\n            if (!this._model) {\n                // disposed\n                ref.dispose();\n                return;\n            }\n            dispose(this._previewModelReference);\n            // show in editor\n            const model = ref.object;\n            if (model) {\n                const scrollType = this._preview.getModel() === model.textEditorModel ? 0 /* Smooth */ : 1 /* Immediate */;\n                const sel = Range.lift(reference.range).collapseToStart();\n                this._previewModelReference = ref;\n                this._preview.setModel(model.textEditorModel);\n                this._preview.setSelection(sel);\n                this._preview.revealRangeInCenter(sel, scrollType);\n            }\n            else {\n                this._preview.setModel(this._previewNotAvailableMessage);\n                ref.dispose();\n            }\n        });\n    }\n};\nReferenceWidget = __decorate([\n    __param(3, IThemeService),\n    __param(4, ITextModelService),\n    __param(5, IInstantiationService),\n    __param(6, peekView.IPeekViewService),\n    __param(7, ILabelService),\n    __param(8, IUndoRedoService),\n    __param(9, IKeybindingService),\n    __param(10, IModeService),\n    __param(11, ILanguageConfigurationService)\n], ReferenceWidget);\nexport { ReferenceWidget };\n// theming\nregisterThemingParticipant((theme, collector) => {\n    const findMatchHighlightColor = theme.getColor(peekView.peekViewResultsMatchHighlight);\n    if (findMatchHighlightColor) {\n        collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { background-color: ${findMatchHighlightColor}; }`);\n    }\n    const referenceHighlightColor = theme.getColor(peekView.peekViewEditorMatchHighlight);\n    if (referenceHighlightColor) {\n        collector.addRule(`.monaco-editor .reference-zone-widget .preview .reference-decoration { background-color: ${referenceHighlightColor}; }`);\n    }\n    const referenceHighlightBorder = theme.getColor(peekView.peekViewEditorMatchHighlightBorder);\n    if (referenceHighlightBorder) {\n        collector.addRule(`.monaco-editor .reference-zone-widget .preview .reference-decoration { border: 2px solid ${referenceHighlightBorder}; box-sizing: border-box; }`);\n    }\n    const hcOutline = theme.getColor(activeContrastBorder);\n    if (hcOutline) {\n        collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { border: 1px dotted ${hcOutline}; box-sizing: border-box; }`);\n    }\n    const resultsBackground = theme.getColor(peekView.peekViewResultsBackground);\n    if (resultsBackground) {\n        collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree { background-color: ${resultsBackground}; }`);\n    }\n    const resultsMatchForeground = theme.getColor(peekView.peekViewResultsMatchForeground);\n    if (resultsMatchForeground) {\n        collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree { color: ${resultsMatchForeground}; }`);\n    }\n    const resultsFileForeground = theme.getColor(peekView.peekViewResultsFileForeground);\n    if (resultsFileForeground) {\n        collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .reference-file { color: ${resultsFileForeground}; }`);\n    }\n    const resultsSelectedBackground = theme.getColor(peekView.peekViewResultsSelectionBackground);\n    if (resultsSelectedBackground) {\n        collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { background-color: ${resultsSelectedBackground}; }`);\n    }\n    const resultsSelectedForeground = theme.getColor(peekView.peekViewResultsSelectionForeground);\n    if (resultsSelectedForeground) {\n        collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { color: ${resultsSelectedForeground} !important; }`);\n    }\n    const editorBackground = theme.getColor(peekView.peekViewEditorBackground);\n    if (editorBackground) {\n        collector.addRule(`.monaco-editor .reference-zone-widget .preview .monaco-editor .monaco-editor-background,` +\n            `.monaco-editor .reference-zone-widget .preview .monaco-editor .inputarea.ime-input {` +\n            `\tbackground-color: ${editorBackground};` +\n            `}`);\n    }\n    const editorGutterBackground = theme.getColor(peekView.peekViewEditorGutterBackground);\n    if (editorGutterBackground) {\n        collector.addRule(`.monaco-editor .reference-zone-widget .preview .monaco-editor .margin {` +\n            `\tbackground-color: ${editorGutterBackground};` +\n            `}`);\n    }\n});\n"]},"metadata":{},"sourceType":"module"}