{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nimport { binarySearch } from '../../../base/common/arrays.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\nimport { LinkedList } from '../../../base/common/linkedList.js';\nimport { compare } from '../../../base/common/strings.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { Range } from '../../common/core/range.js';\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService, MarkerSeverity } from '../../../platform/markers/common/markers.js';\nexport class MarkerCoordinate {\n  constructor(marker, index, total) {\n    this.marker = marker;\n    this.index = index;\n    this.total = total;\n  }\n\n}\nlet MarkerList = class MarkerList {\n  constructor(resourceFilter, _markerService) {\n    this._markerService = _markerService;\n    this._onDidChange = new Emitter();\n    this.onDidChange = this._onDidChange.event;\n    this._dispoables = new DisposableStore();\n    this._markers = [];\n    this._nextIdx = -1;\n\n    if (URI.isUri(resourceFilter)) {\n      this._resourceFilter = uri => uri.toString() === resourceFilter.toString();\n    } else if (resourceFilter) {\n      this._resourceFilter = resourceFilter;\n    }\n\n    const updateMarker = () => {\n      this._markers = this._markerService.read({\n        resource: URI.isUri(resourceFilter) ? resourceFilter : undefined,\n        severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\n      });\n\n      if (typeof resourceFilter === 'function') {\n        this._markers = this._markers.filter(m => this._resourceFilter(m.resource));\n      }\n\n      this._markers.sort(MarkerList._compareMarker);\n    };\n\n    updateMarker();\n\n    this._dispoables.add(_markerService.onMarkerChanged(uris => {\n      if (!this._resourceFilter || uris.some(uri => this._resourceFilter(uri))) {\n        updateMarker();\n        this._nextIdx = -1;\n\n        this._onDidChange.fire();\n      }\n    }));\n  }\n\n  dispose() {\n    this._dispoables.dispose();\n\n    this._onDidChange.dispose();\n  }\n\n  matches(uri) {\n    if (!this._resourceFilter && !uri) {\n      return true;\n    }\n\n    if (!this._resourceFilter || !uri) {\n      return false;\n    }\n\n    return this._resourceFilter(uri);\n  }\n\n  get selected() {\n    const marker = this._markers[this._nextIdx];\n    return marker && new MarkerCoordinate(marker, this._nextIdx + 1, this._markers.length);\n  }\n\n  _initIdx(model, position, fwd) {\n    let found = false;\n\n    let idx = this._markers.findIndex(marker => marker.resource.toString() === model.uri.toString());\n\n    if (idx < 0) {\n      idx = binarySearch(this._markers, {\n        resource: model.uri\n      }, (a, b) => compare(a.resource.toString(), b.resource.toString()));\n\n      if (idx < 0) {\n        idx = ~idx;\n      }\n    }\n\n    for (let i = idx; i < this._markers.length; i++) {\n      let range = Range.lift(this._markers[i]);\n\n      if (range.isEmpty()) {\n        const word = model.getWordAtPosition(range.getStartPosition());\n\n        if (word) {\n          range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\n        }\n      }\n\n      if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\n        this._nextIdx = i;\n        found = true;\n        break;\n      }\n\n      if (this._markers[i].resource.toString() !== model.uri.toString()) {\n        break;\n      }\n    }\n\n    if (!found) {\n      // after the last change\n      this._nextIdx = fwd ? 0 : this._markers.length - 1;\n    }\n\n    if (this._nextIdx < 0) {\n      this._nextIdx = this._markers.length - 1;\n    }\n  }\n\n  resetIndex() {\n    this._nextIdx = -1;\n  }\n\n  move(fwd, model, position) {\n    if (this._markers.length === 0) {\n      return false;\n    }\n\n    let oldIdx = this._nextIdx;\n\n    if (this._nextIdx === -1) {\n      this._initIdx(model, position, fwd);\n    } else if (fwd) {\n      this._nextIdx = (this._nextIdx + 1) % this._markers.length;\n    } else if (!fwd) {\n      this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\n    }\n\n    if (oldIdx !== this._nextIdx) {\n      return true;\n    }\n\n    return false;\n  }\n\n  find(uri, position) {\n    let idx = this._markers.findIndex(marker => marker.resource.toString() === uri.toString());\n\n    if (idx < 0) {\n      return undefined;\n    }\n\n    for (; idx < this._markers.length; idx++) {\n      if (Range.containsPosition(this._markers[idx], position)) {\n        return new MarkerCoordinate(this._markers[idx], idx + 1, this._markers.length);\n      }\n    }\n\n    return undefined;\n  }\n\n  static _compareMarker(a, b) {\n    let res = compare(a.resource.toString(), b.resource.toString());\n\n    if (res === 0) {\n      res = MarkerSeverity.compare(a.severity, b.severity);\n    }\n\n    if (res === 0) {\n      res = Range.compareRangesUsingStarts(a, b);\n    }\n\n    return res;\n  }\n\n};\nMarkerList = __decorate([__param(1, IMarkerService)], MarkerList);\nexport { MarkerList };\nexport const IMarkerNavigationService = createDecorator('IMarkerNavigationService');\nlet MarkerNavigationService = class MarkerNavigationService {\n  constructor(_markerService) {\n    this._markerService = _markerService;\n    this._provider = new LinkedList();\n  }\n\n  getMarkerList(resource) {\n    for (let provider of this._provider) {\n      const result = provider.getMarkerList(resource);\n\n      if (result) {\n        return result;\n      }\n    } // default\n\n\n    return new MarkerList(resource, this._markerService);\n  }\n\n};\nMarkerNavigationService = __decorate([__param(0, IMarkerService)], MarkerNavigationService);\nregisterSingleton(IMarkerNavigationService, MarkerNavigationService, true);","map":{"version":3,"sources":["/home/umut/Documents/cs/cs410/Project2Group14/node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/markerNavigationService.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","binarySearch","Emitter","DisposableStore","LinkedList","compare","URI","Range","registerSingleton","createDecorator","IMarkerService","MarkerSeverity","MarkerCoordinate","constructor","marker","index","total","MarkerList","resourceFilter","_markerService","_onDidChange","onDidChange","event","_dispoables","_markers","_nextIdx","isUri","_resourceFilter","uri","toString","updateMarker","read","resource","undefined","severities","Error","Warning","Info","filter","m","sort","_compareMarker","add","onMarkerChanged","uris","some","fire","dispose","matches","selected","_initIdx","model","position","fwd","found","idx","findIndex","a","b","range","lift","isEmpty","word","getWordAtPosition","getStartPosition","startLineNumber","startColumn","endColumn","containsPosition","isBeforeOrEqual","resetIndex","move","oldIdx","find","res","severity","compareRangesUsingStarts","IMarkerNavigationService","MarkerNavigationService","_provider","getMarkerList","provider","result"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { binarySearch } from '../../../base/common/arrays.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\nimport { LinkedList } from '../../../base/common/linkedList.js';\nimport { compare } from '../../../base/common/strings.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { Range } from '../../common/core/range.js';\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService, MarkerSeverity } from '../../../platform/markers/common/markers.js';\nexport class MarkerCoordinate {\n    constructor(marker, index, total) {\n        this.marker = marker;\n        this.index = index;\n        this.total = total;\n    }\n}\nlet MarkerList = class MarkerList {\n    constructor(resourceFilter, _markerService) {\n        this._markerService = _markerService;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._dispoables = new DisposableStore();\n        this._markers = [];\n        this._nextIdx = -1;\n        if (URI.isUri(resourceFilter)) {\n            this._resourceFilter = uri => uri.toString() === resourceFilter.toString();\n        }\n        else if (resourceFilter) {\n            this._resourceFilter = resourceFilter;\n        }\n        const updateMarker = () => {\n            this._markers = this._markerService.read({\n                resource: URI.isUri(resourceFilter) ? resourceFilter : undefined,\n                severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\n            });\n            if (typeof resourceFilter === 'function') {\n                this._markers = this._markers.filter(m => this._resourceFilter(m.resource));\n            }\n            this._markers.sort(MarkerList._compareMarker);\n        };\n        updateMarker();\n        this._dispoables.add(_markerService.onMarkerChanged(uris => {\n            if (!this._resourceFilter || uris.some(uri => this._resourceFilter(uri))) {\n                updateMarker();\n                this._nextIdx = -1;\n                this._onDidChange.fire();\n            }\n        }));\n    }\n    dispose() {\n        this._dispoables.dispose();\n        this._onDidChange.dispose();\n    }\n    matches(uri) {\n        if (!this._resourceFilter && !uri) {\n            return true;\n        }\n        if (!this._resourceFilter || !uri) {\n            return false;\n        }\n        return this._resourceFilter(uri);\n    }\n    get selected() {\n        const marker = this._markers[this._nextIdx];\n        return marker && new MarkerCoordinate(marker, this._nextIdx + 1, this._markers.length);\n    }\n    _initIdx(model, position, fwd) {\n        let found = false;\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === model.uri.toString());\n        if (idx < 0) {\n            idx = binarySearch(this._markers, { resource: model.uri }, (a, b) => compare(a.resource.toString(), b.resource.toString()));\n            if (idx < 0) {\n                idx = ~idx;\n            }\n        }\n        for (let i = idx; i < this._markers.length; i++) {\n            let range = Range.lift(this._markers[i]);\n            if (range.isEmpty()) {\n                const word = model.getWordAtPosition(range.getStartPosition());\n                if (word) {\n                    range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\n                }\n            }\n            if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\n                this._nextIdx = i;\n                found = true;\n                break;\n            }\n            if (this._markers[i].resource.toString() !== model.uri.toString()) {\n                break;\n            }\n        }\n        if (!found) {\n            // after the last change\n            this._nextIdx = fwd ? 0 : this._markers.length - 1;\n        }\n        if (this._nextIdx < 0) {\n            this._nextIdx = this._markers.length - 1;\n        }\n    }\n    resetIndex() {\n        this._nextIdx = -1;\n    }\n    move(fwd, model, position) {\n        if (this._markers.length === 0) {\n            return false;\n        }\n        let oldIdx = this._nextIdx;\n        if (this._nextIdx === -1) {\n            this._initIdx(model, position, fwd);\n        }\n        else if (fwd) {\n            this._nextIdx = (this._nextIdx + 1) % this._markers.length;\n        }\n        else if (!fwd) {\n            this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\n        }\n        if (oldIdx !== this._nextIdx) {\n            return true;\n        }\n        return false;\n    }\n    find(uri, position) {\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === uri.toString());\n        if (idx < 0) {\n            return undefined;\n        }\n        for (; idx < this._markers.length; idx++) {\n            if (Range.containsPosition(this._markers[idx], position)) {\n                return new MarkerCoordinate(this._markers[idx], idx + 1, this._markers.length);\n            }\n        }\n        return undefined;\n    }\n    static _compareMarker(a, b) {\n        let res = compare(a.resource.toString(), b.resource.toString());\n        if (res === 0) {\n            res = MarkerSeverity.compare(a.severity, b.severity);\n        }\n        if (res === 0) {\n            res = Range.compareRangesUsingStarts(a, b);\n        }\n        return res;\n    }\n};\nMarkerList = __decorate([\n    __param(1, IMarkerService)\n], MarkerList);\nexport { MarkerList };\nexport const IMarkerNavigationService = createDecorator('IMarkerNavigationService');\nlet MarkerNavigationService = class MarkerNavigationService {\n    constructor(_markerService) {\n        this._markerService = _markerService;\n        this._provider = new LinkedList();\n    }\n    getMarkerList(resource) {\n        for (let provider of this._provider) {\n            const result = provider.getMarkerList(resource);\n            if (result) {\n                return result;\n            }\n        }\n        // default\n        return new MarkerList(resource, this._markerService);\n    }\n};\nMarkerNavigationService = __decorate([\n    __param(0, IMarkerService)\n], MarkerNavigationService);\nregisterSingleton(IMarkerNavigationService, MarkerNavigationService, true);\n"]},"metadata":{},"sourceType":"module"}