{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport * as dom from '../../../base/browser/dom.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { LinkedList } from '../../../base/common/linkedList.js';\nimport { ResourceMap } from '../../../base/common/map.js';\nimport { parse } from '../../../base/common/marshalling.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { normalizePath } from '../../../base/common/resources.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { ICodeEditorService } from './codeEditorService.js';\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\nimport { EditorOpenContext } from '../../../platform/editor/common/editor.js';\nimport { matchesScheme } from '../../../platform/opener/common/opener.js';\nlet CommandOpener = class CommandOpener {\n  constructor(_commandService) {\n    this._commandService = _commandService;\n  }\n\n  open(target, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      if (!matchesScheme(target, Schemas.command)) {\n        return false;\n      }\n\n      if (!(options === null || options === void 0 ? void 0 : options.allowCommands)) {\n        // silently ignore commands when command-links are disabled, also\n        // surpress other openers by returning TRUE\n        return true;\n      } // run command or bail out if command isn't known\n\n\n      if (typeof target === 'string') {\n        target = URI.parse(target);\n      } // execute as command\n\n\n      let args = [];\n\n      try {\n        args = parse(decodeURIComponent(target.query));\n      } catch (_a) {\n        // ignore and retry\n        try {\n          args = parse(target.query);\n        } catch (_b) {// ignore error\n        }\n      }\n\n      if (!Array.isArray(args)) {\n        args = [args];\n      }\n\n      yield this._commandService.executeCommand(target.path, ...args);\n      return true;\n    });\n  }\n\n};\nCommandOpener = __decorate([__param(0, ICommandService)], CommandOpener);\nlet EditorOpener = class EditorOpener {\n  constructor(_editorService) {\n    this._editorService = _editorService;\n  }\n\n  open(target, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      if (typeof target === 'string') {\n        target = URI.parse(target);\n      }\n\n      let selection = undefined;\n      const match = /^L?(\\d+)(?:,(\\d+))?/.exec(target.fragment);\n\n      if (match) {\n        // support file:///some/file.js#73,84\n        // support file:///some/file.js#L73\n        selection = {\n          startLineNumber: parseInt(match[1]),\n          startColumn: match[2] ? parseInt(match[2]) : 1\n        }; // remove fragment\n\n        target = target.with({\n          fragment: ''\n        });\n      }\n\n      if (target.scheme === Schemas.file) {\n        target = normalizePath(target); // workaround for non-normalized paths (https://github.com/microsoft/vscode/issues/12954)\n      }\n\n      yield this._editorService.openCodeEditor({\n        resource: target,\n        options: Object.assign({\n          selection,\n          context: (options === null || options === void 0 ? void 0 : options.fromUserGesture) ? EditorOpenContext.USER : EditorOpenContext.API\n        }, options === null || options === void 0 ? void 0 : options.editorOptions)\n      }, this._editorService.getFocusedCodeEditor(), options === null || options === void 0 ? void 0 : options.openToSide);\n      return true;\n    });\n  }\n\n};\nEditorOpener = __decorate([__param(0, ICodeEditorService)], EditorOpener);\nlet OpenerService = class OpenerService {\n  constructor(editorService, commandService) {\n    this._openers = new LinkedList();\n    this._validators = new LinkedList();\n    this._resolvers = new LinkedList();\n    this._resolvedUriTargets = new ResourceMap(uri => uri.with({\n      path: null,\n      fragment: null,\n      query: null\n    }).toString());\n    this._externalOpeners = new LinkedList(); // Default external opener is going through window.open()\n\n    this._defaultExternalOpener = {\n      openExternal: href => __awaiter(this, void 0, void 0, function* () {\n        // ensure to open HTTP/HTTPS links into new windows\n        // to not trigger a navigation. Any other link is\n        // safe to be set as HREF to prevent a blank window\n        // from opening.\n        if (matchesScheme(href, Schemas.http) || matchesScheme(href, Schemas.https)) {\n          dom.windowOpenNoOpener(href);\n        } else {\n          window.location.href = href;\n        }\n\n        return true;\n      })\n    }; // Default opener: any external, maito, http(s), command, and catch-all-editors\n\n    this._openers.push({\n      open: (target, options) => __awaiter(this, void 0, void 0, function* () {\n        if ((options === null || options === void 0 ? void 0 : options.openExternal) || matchesScheme(target, Schemas.mailto) || matchesScheme(target, Schemas.http) || matchesScheme(target, Schemas.https)) {\n          // open externally\n          yield this._doOpenExternal(target, options);\n          return true;\n        }\n\n        return false;\n      })\n    });\n\n    this._openers.push(new CommandOpener(commandService));\n\n    this._openers.push(new EditorOpener(editorService));\n  }\n\n  registerOpener(opener) {\n    const remove = this._openers.unshift(opener);\n\n    return {\n      dispose: remove\n    };\n  }\n\n  registerValidator(validator) {\n    const remove = this._validators.push(validator);\n\n    return {\n      dispose: remove\n    };\n  }\n\n  registerExternalUriResolver(resolver) {\n    const remove = this._resolvers.push(resolver);\n\n    return {\n      dispose: remove\n    };\n  }\n\n  setDefaultExternalOpener(externalOpener) {\n    this._defaultExternalOpener = externalOpener;\n  }\n\n  registerExternalOpener(opener) {\n    const remove = this._externalOpeners.push(opener);\n\n    return {\n      dispose: remove\n    };\n  }\n\n  open(target, options) {\n    var _a;\n\n    return __awaiter(this, void 0, void 0, function* () {\n      // check with contributed validators\n      const targetURI = typeof target === 'string' ? URI.parse(target) : target; // validate against the original URI that this URI resolves to, if one exists\n\n      const validationTarget = (_a = this._resolvedUriTargets.get(targetURI)) !== null && _a !== void 0 ? _a : target;\n\n      for (const validator of this._validators) {\n        if (!(yield validator.shouldOpen(validationTarget))) {\n          return false;\n        }\n      } // check with contributed openers\n\n\n      for (const opener of this._openers) {\n        const handled = yield opener.open(target, options);\n\n        if (handled) {\n          return true;\n        }\n      }\n\n      return false;\n    });\n  }\n\n  resolveExternalUri(resource, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      for (const resolver of this._resolvers) {\n        try {\n          const result = yield resolver.resolveExternalUri(resource, options);\n\n          if (result) {\n            if (!this._resolvedUriTargets.has(result.resolved)) {\n              this._resolvedUriTargets.set(result.resolved, resource);\n            }\n\n            return result;\n          }\n        } catch (_a) {// noop\n        }\n      }\n\n      throw new Error('Could not resolve external URI: ' + resource.toString());\n    });\n  }\n\n  _doOpenExternal(resource, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      //todo@jrieken IExternalUriResolver should support `uri: URI | string`\n      const uri = typeof resource === 'string' ? URI.parse(resource) : resource;\n      let externalUri;\n\n      try {\n        externalUri = (yield this.resolveExternalUri(uri, options)).resolved;\n      } catch (_a) {\n        externalUri = uri;\n      }\n\n      let href;\n\n      if (typeof resource === 'string' && uri.toString() === externalUri.toString()) {\n        // open the url-string AS IS\n        href = resource;\n      } else {\n        // open URI using the toString(noEncode)+encodeURI-trick\n        href = encodeURI(externalUri.toString(true));\n      }\n\n      if (options === null || options === void 0 ? void 0 : options.allowContributedOpeners) {\n        const preferredOpenerId = typeof (options === null || options === void 0 ? void 0 : options.allowContributedOpeners) === 'string' ? options === null || options === void 0 ? void 0 : options.allowContributedOpeners : undefined;\n\n        for (const opener of this._externalOpeners) {\n          const didOpen = yield opener.openExternal(href, {\n            sourceUri: uri,\n            preferredOpenerId\n          }, CancellationToken.None);\n\n          if (didOpen) {\n            return true;\n          }\n        }\n      }\n\n      return this._defaultExternalOpener.openExternal(href, {\n        sourceUri: uri\n      }, CancellationToken.None);\n    });\n  }\n\n  dispose() {\n    this._validators.clear();\n  }\n\n};\nOpenerService = __decorate([__param(0, ICodeEditorService), __param(1, ICommandService)], OpenerService);\nexport { OpenerService };","map":{"version":3,"sources":["/home/umut/Documents/cs/cs410/Project2Group14/node_modules/monaco-editor/esm/vs/editor/browser/services/openerService.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","dom","CancellationToken","LinkedList","ResourceMap","parse","Schemas","normalizePath","URI","ICodeEditorService","ICommandService","EditorOpenContext","matchesScheme","CommandOpener","constructor","_commandService","open","options","command","allowCommands","args","decodeURIComponent","query","_a","_b","Array","isArray","executeCommand","path","EditorOpener","_editorService","selection","undefined","match","exec","fragment","startLineNumber","parseInt","startColumn","with","scheme","file","openCodeEditor","resource","assign","context","fromUserGesture","USER","API","editorOptions","getFocusedCodeEditor","openToSide","OpenerService","editorService","commandService","_openers","_validators","_resolvers","_resolvedUriTargets","uri","toString","_externalOpeners","_defaultExternalOpener","openExternal","href","http","https","windowOpenNoOpener","window","location","push","mailto","_doOpenExternal","registerOpener","opener","remove","unshift","dispose","registerValidator","validator","registerExternalUriResolver","resolver","setDefaultExternalOpener","externalOpener","registerExternalOpener","targetURI","validationTarget","get","shouldOpen","handled","resolveExternalUri","has","resolved","set","Error","externalUri","encodeURI","allowContributedOpeners","preferredOpenerId","didOpen","sourceUri","None","clear"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../base/browser/dom.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { LinkedList } from '../../../base/common/linkedList.js';\nimport { ResourceMap } from '../../../base/common/map.js';\nimport { parse } from '../../../base/common/marshalling.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { normalizePath } from '../../../base/common/resources.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { ICodeEditorService } from './codeEditorService.js';\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\nimport { EditorOpenContext } from '../../../platform/editor/common/editor.js';\nimport { matchesScheme } from '../../../platform/opener/common/opener.js';\nlet CommandOpener = class CommandOpener {\n    constructor(_commandService) {\n        this._commandService = _commandService;\n    }\n    open(target, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!matchesScheme(target, Schemas.command)) {\n                return false;\n            }\n            if (!(options === null || options === void 0 ? void 0 : options.allowCommands)) {\n                // silently ignore commands when command-links are disabled, also\n                // surpress other openers by returning TRUE\n                return true;\n            }\n            // run command or bail out if command isn't known\n            if (typeof target === 'string') {\n                target = URI.parse(target);\n            }\n            // execute as command\n            let args = [];\n            try {\n                args = parse(decodeURIComponent(target.query));\n            }\n            catch (_a) {\n                // ignore and retry\n                try {\n                    args = parse(target.query);\n                }\n                catch (_b) {\n                    // ignore error\n                }\n            }\n            if (!Array.isArray(args)) {\n                args = [args];\n            }\n            yield this._commandService.executeCommand(target.path, ...args);\n            return true;\n        });\n    }\n};\nCommandOpener = __decorate([\n    __param(0, ICommandService)\n], CommandOpener);\nlet EditorOpener = class EditorOpener {\n    constructor(_editorService) {\n        this._editorService = _editorService;\n    }\n    open(target, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (typeof target === 'string') {\n                target = URI.parse(target);\n            }\n            let selection = undefined;\n            const match = /^L?(\\d+)(?:,(\\d+))?/.exec(target.fragment);\n            if (match) {\n                // support file:///some/file.js#73,84\n                // support file:///some/file.js#L73\n                selection = {\n                    startLineNumber: parseInt(match[1]),\n                    startColumn: match[2] ? parseInt(match[2]) : 1\n                };\n                // remove fragment\n                target = target.with({ fragment: '' });\n            }\n            if (target.scheme === Schemas.file) {\n                target = normalizePath(target); // workaround for non-normalized paths (https://github.com/microsoft/vscode/issues/12954)\n            }\n            yield this._editorService.openCodeEditor({\n                resource: target,\n                options: Object.assign({ selection, context: (options === null || options === void 0 ? void 0 : options.fromUserGesture) ? EditorOpenContext.USER : EditorOpenContext.API }, options === null || options === void 0 ? void 0 : options.editorOptions)\n            }, this._editorService.getFocusedCodeEditor(), options === null || options === void 0 ? void 0 : options.openToSide);\n            return true;\n        });\n    }\n};\nEditorOpener = __decorate([\n    __param(0, ICodeEditorService)\n], EditorOpener);\nlet OpenerService = class OpenerService {\n    constructor(editorService, commandService) {\n        this._openers = new LinkedList();\n        this._validators = new LinkedList();\n        this._resolvers = new LinkedList();\n        this._resolvedUriTargets = new ResourceMap(uri => uri.with({ path: null, fragment: null, query: null }).toString());\n        this._externalOpeners = new LinkedList();\n        // Default external opener is going through window.open()\n        this._defaultExternalOpener = {\n            openExternal: (href) => __awaiter(this, void 0, void 0, function* () {\n                // ensure to open HTTP/HTTPS links into new windows\n                // to not trigger a navigation. Any other link is\n                // safe to be set as HREF to prevent a blank window\n                // from opening.\n                if (matchesScheme(href, Schemas.http) || matchesScheme(href, Schemas.https)) {\n                    dom.windowOpenNoOpener(href);\n                }\n                else {\n                    window.location.href = href;\n                }\n                return true;\n            })\n        };\n        // Default opener: any external, maito, http(s), command, and catch-all-editors\n        this._openers.push({\n            open: (target, options) => __awaiter(this, void 0, void 0, function* () {\n                if ((options === null || options === void 0 ? void 0 : options.openExternal) || matchesScheme(target, Schemas.mailto) || matchesScheme(target, Schemas.http) || matchesScheme(target, Schemas.https)) {\n                    // open externally\n                    yield this._doOpenExternal(target, options);\n                    return true;\n                }\n                return false;\n            })\n        });\n        this._openers.push(new CommandOpener(commandService));\n        this._openers.push(new EditorOpener(editorService));\n    }\n    registerOpener(opener) {\n        const remove = this._openers.unshift(opener);\n        return { dispose: remove };\n    }\n    registerValidator(validator) {\n        const remove = this._validators.push(validator);\n        return { dispose: remove };\n    }\n    registerExternalUriResolver(resolver) {\n        const remove = this._resolvers.push(resolver);\n        return { dispose: remove };\n    }\n    setDefaultExternalOpener(externalOpener) {\n        this._defaultExternalOpener = externalOpener;\n    }\n    registerExternalOpener(opener) {\n        const remove = this._externalOpeners.push(opener);\n        return { dispose: remove };\n    }\n    open(target, options) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            // check with contributed validators\n            const targetURI = typeof target === 'string' ? URI.parse(target) : target;\n            // validate against the original URI that this URI resolves to, if one exists\n            const validationTarget = (_a = this._resolvedUriTargets.get(targetURI)) !== null && _a !== void 0 ? _a : target;\n            for (const validator of this._validators) {\n                if (!(yield validator.shouldOpen(validationTarget))) {\n                    return false;\n                }\n            }\n            // check with contributed openers\n            for (const opener of this._openers) {\n                const handled = yield opener.open(target, options);\n                if (handled) {\n                    return true;\n                }\n            }\n            return false;\n        });\n    }\n    resolveExternalUri(resource, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            for (const resolver of this._resolvers) {\n                try {\n                    const result = yield resolver.resolveExternalUri(resource, options);\n                    if (result) {\n                        if (!this._resolvedUriTargets.has(result.resolved)) {\n                            this._resolvedUriTargets.set(result.resolved, resource);\n                        }\n                        return result;\n                    }\n                }\n                catch (_a) {\n                    // noop\n                }\n            }\n            throw new Error('Could not resolve external URI: ' + resource.toString());\n        });\n    }\n    _doOpenExternal(resource, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            //todo@jrieken IExternalUriResolver should support `uri: URI | string`\n            const uri = typeof resource === 'string' ? URI.parse(resource) : resource;\n            let externalUri;\n            try {\n                externalUri = (yield this.resolveExternalUri(uri, options)).resolved;\n            }\n            catch (_a) {\n                externalUri = uri;\n            }\n            let href;\n            if (typeof resource === 'string' && uri.toString() === externalUri.toString()) {\n                // open the url-string AS IS\n                href = resource;\n            }\n            else {\n                // open URI using the toString(noEncode)+encodeURI-trick\n                href = encodeURI(externalUri.toString(true));\n            }\n            if (options === null || options === void 0 ? void 0 : options.allowContributedOpeners) {\n                const preferredOpenerId = typeof (options === null || options === void 0 ? void 0 : options.allowContributedOpeners) === 'string' ? options === null || options === void 0 ? void 0 : options.allowContributedOpeners : undefined;\n                for (const opener of this._externalOpeners) {\n                    const didOpen = yield opener.openExternal(href, {\n                        sourceUri: uri,\n                        preferredOpenerId,\n                    }, CancellationToken.None);\n                    if (didOpen) {\n                        return true;\n                    }\n                }\n            }\n            return this._defaultExternalOpener.openExternal(href, { sourceUri: uri }, CancellationToken.None);\n        });\n    }\n    dispose() {\n        this._validators.clear();\n    }\n};\nOpenerService = __decorate([\n    __param(0, ICodeEditorService),\n    __param(1, ICommandService)\n], OpenerService);\nexport { OpenerService };\n"]},"metadata":{},"sourceType":"module"}