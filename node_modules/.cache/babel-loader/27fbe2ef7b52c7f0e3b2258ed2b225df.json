{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport * as DOM from '../../dom.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { ActionViewItem, BaseActionViewItem } from './actionViewItems.js';\nimport { ActionRunner } from '../../../common/actions.js';\nimport { Emitter } from '../../../common/event.js';\nimport { Disposable, dispose } from '../../../common/lifecycle.js';\nimport * as types from '../../../common/types.js';\nimport './actionbar.css';\nexport class ActionBar extends Disposable {\n  constructor(container) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var _a, _b, _c, _d, _e, _f;\n\n    super(); // Trigger Key Tracking\n\n    this.triggerKeyDown = false;\n    this.focusable = true;\n    this._onDidBlur = this._register(new Emitter());\n    this.onDidBlur = this._onDidBlur.event;\n    this._onDidCancel = this._register(new Emitter({\n      onFirstListenerAdd: () => this.cancelHasListener = true\n    }));\n    this.onDidCancel = this._onDidCancel.event;\n    this.cancelHasListener = false;\n    this._onDidRun = this._register(new Emitter());\n    this.onDidRun = this._onDidRun.event;\n    this._onBeforeRun = this._register(new Emitter());\n    this.onBeforeRun = this._onBeforeRun.event;\n    this.options = options;\n    this._context = (_a = options.context) !== null && _a !== void 0 ? _a : null;\n    this._orientation = (_b = this.options.orientation) !== null && _b !== void 0 ? _b : 0\n    /* HORIZONTAL */\n    ;\n    this._triggerKeys = {\n      keyDown: (_d = (_c = this.options.triggerKeys) === null || _c === void 0 ? void 0 : _c.keyDown) !== null && _d !== void 0 ? _d : false,\n      keys: (_f = (_e = this.options.triggerKeys) === null || _e === void 0 ? void 0 : _e.keys) !== null && _f !== void 0 ? _f : [3\n      /* Enter */\n      , 10\n      /* Space */\n      ]\n    };\n\n    if (this.options.actionRunner) {\n      this._actionRunner = this.options.actionRunner;\n    } else {\n      this._actionRunner = new ActionRunner();\n\n      this._register(this._actionRunner);\n    }\n\n    this._register(this._actionRunner.onDidRun(e => this._onDidRun.fire(e)));\n\n    this._register(this._actionRunner.onBeforeRun(e => this._onBeforeRun.fire(e)));\n\n    this._actionIds = [];\n    this.viewItems = [];\n    this.focusedItem = undefined;\n    this.domNode = document.createElement('div');\n    this.domNode.className = 'monaco-action-bar';\n\n    if (options.animated !== false) {\n      this.domNode.classList.add('animated');\n    }\n\n    let previousKeys;\n    let nextKeys;\n\n    switch (this._orientation) {\n      case 0\n      /* HORIZONTAL */\n      :\n        previousKeys = [15\n        /* LeftArrow */\n        ];\n        nextKeys = [17\n        /* RightArrow */\n        ];\n        break;\n\n      case 1\n      /* VERTICAL */\n      :\n        previousKeys = [16\n        /* UpArrow */\n        ];\n        nextKeys = [18\n        /* DownArrow */\n        ];\n        this.domNode.className += ' vertical';\n        break;\n    }\n\n    this._register(DOM.addDisposableListener(this.domNode, DOM.EventType.KEY_DOWN, e => {\n      const event = new StandardKeyboardEvent(e);\n      let eventHandled = true;\n      const focusedItem = typeof this.focusedItem === 'number' ? this.viewItems[this.focusedItem] : undefined;\n\n      if (previousKeys && (event.equals(previousKeys[0]) || event.equals(previousKeys[1]))) {\n        eventHandled = this.focusPrevious();\n      } else if (nextKeys && (event.equals(nextKeys[0]) || event.equals(nextKeys[1]))) {\n        eventHandled = this.focusNext();\n      } else if (event.equals(9\n      /* Escape */\n      ) && this.cancelHasListener) {\n        this._onDidCancel.fire();\n      } else if (event.equals(14\n      /* Home */\n      )) {\n        eventHandled = this.focusFirst();\n      } else if (event.equals(13\n      /* End */\n      )) {\n        eventHandled = this.focusLast();\n      } else if (event.equals(2\n      /* Tab */\n      ) && focusedItem instanceof BaseActionViewItem && focusedItem.trapsArrowNavigation) {\n        eventHandled = this.focusNext();\n      } else if (this.isTriggerKeyEvent(event)) {\n        // Staying out of the else branch even if not triggered\n        if (this._triggerKeys.keyDown) {\n          this.doTrigger(event);\n        } else {\n          this.triggerKeyDown = true;\n        }\n      } else {\n        eventHandled = false;\n      }\n\n      if (eventHandled) {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    }));\n\n    this._register(DOM.addDisposableListener(this.domNode, DOM.EventType.KEY_UP, e => {\n      const event = new StandardKeyboardEvent(e); // Run action on Enter/Space\n\n      if (this.isTriggerKeyEvent(event)) {\n        if (!this._triggerKeys.keyDown && this.triggerKeyDown) {\n          this.triggerKeyDown = false;\n          this.doTrigger(event);\n        }\n\n        event.preventDefault();\n        event.stopPropagation();\n      } // Recompute focused item\n      else if (event.equals(2\n      /* Tab */\n      ) || event.equals(1024\n      /* Shift */\n      | 2\n      /* Tab */\n      )) {\n        this.updateFocusedItem();\n      }\n    }));\n\n    this.focusTracker = this._register(DOM.trackFocus(this.domNode));\n\n    this._register(this.focusTracker.onDidBlur(() => {\n      if (DOM.getActiveElement() === this.domNode || !DOM.isAncestor(DOM.getActiveElement(), this.domNode)) {\n        this._onDidBlur.fire();\n\n        this.focusedItem = undefined;\n        this.triggerKeyDown = false;\n      }\n    }));\n\n    this._register(this.focusTracker.onDidFocus(() => this.updateFocusedItem()));\n\n    this.actionsList = document.createElement('ul');\n    this.actionsList.className = 'actions-container';\n    this.actionsList.setAttribute('role', 'toolbar');\n\n    if (this.options.ariaLabel) {\n      this.actionsList.setAttribute('aria-label', this.options.ariaLabel);\n    }\n\n    this.domNode.appendChild(this.actionsList);\n    container.appendChild(this.domNode);\n  }\n\n  isTriggerKeyEvent(event) {\n    let ret = false;\n\n    this._triggerKeys.keys.forEach(keyCode => {\n      ret = ret || event.equals(keyCode);\n    });\n\n    return ret;\n  }\n\n  updateFocusedItem() {\n    for (let i = 0; i < this.actionsList.children.length; i++) {\n      const elem = this.actionsList.children[i];\n\n      if (DOM.isAncestor(DOM.getActiveElement(), elem)) {\n        this.focusedItem = i;\n        break;\n      }\n    }\n  }\n\n  get context() {\n    return this._context;\n  }\n\n  set context(context) {\n    this._context = context;\n    this.viewItems.forEach(i => i.setActionContext(context));\n  }\n\n  get actionRunner() {\n    return this._actionRunner;\n  }\n\n  set actionRunner(actionRunner) {\n    if (actionRunner) {\n      this._actionRunner = actionRunner;\n      this.viewItems.forEach(item => item.actionRunner = actionRunner);\n    }\n  }\n\n  getContainer() {\n    return this.domNode;\n  }\n\n  push(arg) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const actions = Array.isArray(arg) ? arg : [arg];\n    let index = types.isNumber(options.index) ? options.index : null;\n    actions.forEach(action => {\n      const actionViewItemElement = document.createElement('li');\n      actionViewItemElement.className = 'action-item';\n      actionViewItemElement.setAttribute('role', 'presentation'); // Prevent native context menu on actions\n\n      if (!this.options.allowContextMenu) {\n        this._register(DOM.addDisposableListener(actionViewItemElement, DOM.EventType.CONTEXT_MENU, e => {\n          DOM.EventHelper.stop(e, true);\n        }));\n      }\n\n      let item;\n\n      if (this.options.actionViewItemProvider) {\n        item = this.options.actionViewItemProvider(action);\n      }\n\n      if (!item) {\n        item = new ActionViewItem(this.context, action, options);\n      }\n\n      item.actionRunner = this._actionRunner;\n      item.setActionContext(this.context);\n      item.render(actionViewItemElement);\n\n      if (this.focusable && item instanceof BaseActionViewItem && this.viewItems.length === 0) {\n        // We need to allow for the first enabled item to be focused on using tab navigation #106441\n        item.setFocusable(true);\n      }\n\n      if (index === null || index < 0 || index >= this.actionsList.children.length) {\n        this.actionsList.appendChild(actionViewItemElement);\n        this.viewItems.push(item);\n\n        this._actionIds.push(action.id);\n      } else {\n        this.actionsList.insertBefore(actionViewItemElement, this.actionsList.children[index]);\n        this.viewItems.splice(index, 0, item);\n\n        this._actionIds.splice(index, 0, action.id);\n\n        index++;\n      }\n    });\n\n    if (typeof this.focusedItem === 'number') {\n      // After a clear actions might be re-added to simply toggle some actions. We should preserve focus #97128\n      this.focus(this.focusedItem);\n    }\n  }\n\n  clear() {\n    dispose(this.viewItems);\n    this.viewItems = [];\n    this._actionIds = [];\n    DOM.clearNode(this.actionsList);\n  }\n\n  length() {\n    return this.viewItems.length;\n  }\n\n  focus(arg) {\n    let selectFirst = false;\n    let index = undefined;\n\n    if (arg === undefined) {\n      selectFirst = true;\n    } else if (typeof arg === 'number') {\n      index = arg;\n    } else if (typeof arg === 'boolean') {\n      selectFirst = arg;\n    }\n\n    if (selectFirst && typeof this.focusedItem === 'undefined') {\n      const firstEnabled = this.viewItems.findIndex(item => item.isEnabled()); // Focus the first enabled item\n\n      this.focusedItem = firstEnabled === -1 ? undefined : firstEnabled;\n      this.updateFocus();\n    } else {\n      if (index !== undefined) {\n        this.focusedItem = index;\n      }\n\n      this.updateFocus();\n    }\n  }\n\n  focusFirst() {\n    this.focusedItem = this.length() > 1 ? 1 : 0;\n    return this.focusPrevious();\n  }\n\n  focusLast() {\n    this.focusedItem = this.length() < 2 ? 0 : this.length() - 2;\n    return this.focusNext();\n  }\n\n  focusNext() {\n    if (typeof this.focusedItem === 'undefined') {\n      this.focusedItem = this.viewItems.length - 1;\n    } else if (this.viewItems.length <= 1) {\n      return false;\n    }\n\n    const startIndex = this.focusedItem;\n    let item;\n\n    do {\n      if (this.options.preventLoopNavigation && this.focusedItem + 1 >= this.viewItems.length) {\n        this.focusedItem = startIndex;\n        return false;\n      }\n\n      this.focusedItem = (this.focusedItem + 1) % this.viewItems.length;\n      item = this.viewItems[this.focusedItem];\n    } while (this.focusedItem !== startIndex && this.options.focusOnlyEnabledItems && !item.isEnabled());\n\n    this.updateFocus();\n    return true;\n  }\n\n  focusPrevious() {\n    if (typeof this.focusedItem === 'undefined') {\n      this.focusedItem = 0;\n    } else if (this.viewItems.length <= 1) {\n      return false;\n    }\n\n    const startIndex = this.focusedItem;\n    let item;\n\n    do {\n      this.focusedItem = this.focusedItem - 1;\n\n      if (this.focusedItem < 0) {\n        if (this.options.preventLoopNavigation) {\n          this.focusedItem = startIndex;\n          return false;\n        }\n\n        this.focusedItem = this.viewItems.length - 1;\n      }\n\n      item = this.viewItems[this.focusedItem];\n    } while (this.focusedItem !== startIndex && this.options.focusOnlyEnabledItems && !item.isEnabled());\n\n    this.updateFocus(true);\n    return true;\n  }\n\n  updateFocus(fromRight, preventScroll) {\n    if (typeof this.focusedItem === 'undefined') {\n      this.actionsList.focus({\n        preventScroll\n      });\n    }\n\n    for (let i = 0; i < this.viewItems.length; i++) {\n      const item = this.viewItems[i];\n      const actionViewItem = item;\n\n      if (i === this.focusedItem) {\n        let focusItem = true;\n\n        if (!types.isFunction(actionViewItem.focus)) {\n          focusItem = false;\n        }\n\n        if (this.options.focusOnlyEnabledItems && types.isFunction(item.isEnabled) && !item.isEnabled()) {\n          focusItem = false;\n        }\n\n        if (focusItem) {\n          actionViewItem.focus(fromRight);\n        } else {\n          this.actionsList.focus({\n            preventScroll\n          });\n        }\n      } else {\n        if (types.isFunction(actionViewItem.blur)) {\n          actionViewItem.blur();\n        }\n      }\n    }\n  }\n\n  doTrigger(event) {\n    if (typeof this.focusedItem === 'undefined') {\n      return; //nothing to focus\n    } // trigger action\n\n\n    const actionViewItem = this.viewItems[this.focusedItem];\n\n    if (actionViewItem instanceof BaseActionViewItem) {\n      const context = actionViewItem._context === null || actionViewItem._context === undefined ? event : actionViewItem._context;\n      this.run(actionViewItem._action, context);\n    }\n  }\n\n  run(action, context) {\n    return __awaiter(this, void 0, void 0, function* () {\n      yield this._actionRunner.run(action, context);\n    });\n  }\n\n  dispose() {\n    dispose(this.viewItems);\n    this.viewItems = [];\n    this._actionIds = [];\n    this.getContainer().remove();\n    super.dispose();\n  }\n\n}","map":{"version":3,"sources":["/home/umut/Documents/cs/cs410/Project2Group14/node_modules/monaco-editor/esm/vs/base/browser/ui/actionbar/actionbar.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","DOM","StandardKeyboardEvent","ActionViewItem","BaseActionViewItem","ActionRunner","Emitter","Disposable","dispose","types","ActionBar","constructor","container","options","_a","_b","_c","_d","_e","_f","triggerKeyDown","focusable","_onDidBlur","_register","onDidBlur","event","_onDidCancel","onFirstListenerAdd","cancelHasListener","onDidCancel","_onDidRun","onDidRun","_onBeforeRun","onBeforeRun","_context","context","_orientation","orientation","_triggerKeys","keyDown","triggerKeys","keys","actionRunner","_actionRunner","fire","_actionIds","viewItems","focusedItem","undefined","domNode","document","createElement","className","animated","classList","add","previousKeys","nextKeys","addDisposableListener","EventType","KEY_DOWN","eventHandled","equals","focusPrevious","focusNext","focusFirst","focusLast","trapsArrowNavigation","isTriggerKeyEvent","doTrigger","preventDefault","stopPropagation","KEY_UP","updateFocusedItem","focusTracker","trackFocus","getActiveElement","isAncestor","onDidFocus","actionsList","setAttribute","ariaLabel","appendChild","ret","forEach","keyCode","i","children","length","elem","setActionContext","item","getContainer","push","arg","actions","Array","isArray","index","isNumber","action","actionViewItemElement","allowContextMenu","CONTEXT_MENU","EventHelper","stop","actionViewItemProvider","render","setFocusable","id","insertBefore","splice","focus","clear","clearNode","selectFirst","firstEnabled","findIndex","isEnabled","updateFocus","startIndex","preventLoopNavigation","focusOnlyEnabledItems","fromRight","preventScroll","actionViewItem","focusItem","isFunction","blur","run","_action","remove"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as DOM from '../../dom.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { ActionViewItem, BaseActionViewItem } from './actionViewItems.js';\nimport { ActionRunner } from '../../../common/actions.js';\nimport { Emitter } from '../../../common/event.js';\nimport { Disposable, dispose } from '../../../common/lifecycle.js';\nimport * as types from '../../../common/types.js';\nimport './actionbar.css';\nexport class ActionBar extends Disposable {\n    constructor(container, options = {}) {\n        var _a, _b, _c, _d, _e, _f;\n        super();\n        // Trigger Key Tracking\n        this.triggerKeyDown = false;\n        this.focusable = true;\n        this._onDidBlur = this._register(new Emitter());\n        this.onDidBlur = this._onDidBlur.event;\n        this._onDidCancel = this._register(new Emitter({ onFirstListenerAdd: () => this.cancelHasListener = true }));\n        this.onDidCancel = this._onDidCancel.event;\n        this.cancelHasListener = false;\n        this._onDidRun = this._register(new Emitter());\n        this.onDidRun = this._onDidRun.event;\n        this._onBeforeRun = this._register(new Emitter());\n        this.onBeforeRun = this._onBeforeRun.event;\n        this.options = options;\n        this._context = (_a = options.context) !== null && _a !== void 0 ? _a : null;\n        this._orientation = (_b = this.options.orientation) !== null && _b !== void 0 ? _b : 0 /* HORIZONTAL */;\n        this._triggerKeys = {\n            keyDown: (_d = (_c = this.options.triggerKeys) === null || _c === void 0 ? void 0 : _c.keyDown) !== null && _d !== void 0 ? _d : false,\n            keys: (_f = (_e = this.options.triggerKeys) === null || _e === void 0 ? void 0 : _e.keys) !== null && _f !== void 0 ? _f : [3 /* Enter */, 10 /* Space */]\n        };\n        if (this.options.actionRunner) {\n            this._actionRunner = this.options.actionRunner;\n        }\n        else {\n            this._actionRunner = new ActionRunner();\n            this._register(this._actionRunner);\n        }\n        this._register(this._actionRunner.onDidRun(e => this._onDidRun.fire(e)));\n        this._register(this._actionRunner.onBeforeRun(e => this._onBeforeRun.fire(e)));\n        this._actionIds = [];\n        this.viewItems = [];\n        this.focusedItem = undefined;\n        this.domNode = document.createElement('div');\n        this.domNode.className = 'monaco-action-bar';\n        if (options.animated !== false) {\n            this.domNode.classList.add('animated');\n        }\n        let previousKeys;\n        let nextKeys;\n        switch (this._orientation) {\n            case 0 /* HORIZONTAL */:\n                previousKeys = [15 /* LeftArrow */];\n                nextKeys = [17 /* RightArrow */];\n                break;\n            case 1 /* VERTICAL */:\n                previousKeys = [16 /* UpArrow */];\n                nextKeys = [18 /* DownArrow */];\n                this.domNode.className += ' vertical';\n                break;\n        }\n        this._register(DOM.addDisposableListener(this.domNode, DOM.EventType.KEY_DOWN, e => {\n            const event = new StandardKeyboardEvent(e);\n            let eventHandled = true;\n            const focusedItem = typeof this.focusedItem === 'number' ? this.viewItems[this.focusedItem] : undefined;\n            if (previousKeys && (event.equals(previousKeys[0]) || event.equals(previousKeys[1]))) {\n                eventHandled = this.focusPrevious();\n            }\n            else if (nextKeys && (event.equals(nextKeys[0]) || event.equals(nextKeys[1]))) {\n                eventHandled = this.focusNext();\n            }\n            else if (event.equals(9 /* Escape */) && this.cancelHasListener) {\n                this._onDidCancel.fire();\n            }\n            else if (event.equals(14 /* Home */)) {\n                eventHandled = this.focusFirst();\n            }\n            else if (event.equals(13 /* End */)) {\n                eventHandled = this.focusLast();\n            }\n            else if (event.equals(2 /* Tab */) && focusedItem instanceof BaseActionViewItem && focusedItem.trapsArrowNavigation) {\n                eventHandled = this.focusNext();\n            }\n            else if (this.isTriggerKeyEvent(event)) {\n                // Staying out of the else branch even if not triggered\n                if (this._triggerKeys.keyDown) {\n                    this.doTrigger(event);\n                }\n                else {\n                    this.triggerKeyDown = true;\n                }\n            }\n            else {\n                eventHandled = false;\n            }\n            if (eventHandled) {\n                event.preventDefault();\n                event.stopPropagation();\n            }\n        }));\n        this._register(DOM.addDisposableListener(this.domNode, DOM.EventType.KEY_UP, e => {\n            const event = new StandardKeyboardEvent(e);\n            // Run action on Enter/Space\n            if (this.isTriggerKeyEvent(event)) {\n                if (!this._triggerKeys.keyDown && this.triggerKeyDown) {\n                    this.triggerKeyDown = false;\n                    this.doTrigger(event);\n                }\n                event.preventDefault();\n                event.stopPropagation();\n            }\n            // Recompute focused item\n            else if (event.equals(2 /* Tab */) || event.equals(1024 /* Shift */ | 2 /* Tab */)) {\n                this.updateFocusedItem();\n            }\n        }));\n        this.focusTracker = this._register(DOM.trackFocus(this.domNode));\n        this._register(this.focusTracker.onDidBlur(() => {\n            if (DOM.getActiveElement() === this.domNode || !DOM.isAncestor(DOM.getActiveElement(), this.domNode)) {\n                this._onDidBlur.fire();\n                this.focusedItem = undefined;\n                this.triggerKeyDown = false;\n            }\n        }));\n        this._register(this.focusTracker.onDidFocus(() => this.updateFocusedItem()));\n        this.actionsList = document.createElement('ul');\n        this.actionsList.className = 'actions-container';\n        this.actionsList.setAttribute('role', 'toolbar');\n        if (this.options.ariaLabel) {\n            this.actionsList.setAttribute('aria-label', this.options.ariaLabel);\n        }\n        this.domNode.appendChild(this.actionsList);\n        container.appendChild(this.domNode);\n    }\n    isTriggerKeyEvent(event) {\n        let ret = false;\n        this._triggerKeys.keys.forEach(keyCode => {\n            ret = ret || event.equals(keyCode);\n        });\n        return ret;\n    }\n    updateFocusedItem() {\n        for (let i = 0; i < this.actionsList.children.length; i++) {\n            const elem = this.actionsList.children[i];\n            if (DOM.isAncestor(DOM.getActiveElement(), elem)) {\n                this.focusedItem = i;\n                break;\n            }\n        }\n    }\n    get context() {\n        return this._context;\n    }\n    set context(context) {\n        this._context = context;\n        this.viewItems.forEach(i => i.setActionContext(context));\n    }\n    get actionRunner() {\n        return this._actionRunner;\n    }\n    set actionRunner(actionRunner) {\n        if (actionRunner) {\n            this._actionRunner = actionRunner;\n            this.viewItems.forEach(item => item.actionRunner = actionRunner);\n        }\n    }\n    getContainer() {\n        return this.domNode;\n    }\n    push(arg, options = {}) {\n        const actions = Array.isArray(arg) ? arg : [arg];\n        let index = types.isNumber(options.index) ? options.index : null;\n        actions.forEach((action) => {\n            const actionViewItemElement = document.createElement('li');\n            actionViewItemElement.className = 'action-item';\n            actionViewItemElement.setAttribute('role', 'presentation');\n            // Prevent native context menu on actions\n            if (!this.options.allowContextMenu) {\n                this._register(DOM.addDisposableListener(actionViewItemElement, DOM.EventType.CONTEXT_MENU, (e) => {\n                    DOM.EventHelper.stop(e, true);\n                }));\n            }\n            let item;\n            if (this.options.actionViewItemProvider) {\n                item = this.options.actionViewItemProvider(action);\n            }\n            if (!item) {\n                item = new ActionViewItem(this.context, action, options);\n            }\n            item.actionRunner = this._actionRunner;\n            item.setActionContext(this.context);\n            item.render(actionViewItemElement);\n            if (this.focusable && item instanceof BaseActionViewItem && this.viewItems.length === 0) {\n                // We need to allow for the first enabled item to be focused on using tab navigation #106441\n                item.setFocusable(true);\n            }\n            if (index === null || index < 0 || index >= this.actionsList.children.length) {\n                this.actionsList.appendChild(actionViewItemElement);\n                this.viewItems.push(item);\n                this._actionIds.push(action.id);\n            }\n            else {\n                this.actionsList.insertBefore(actionViewItemElement, this.actionsList.children[index]);\n                this.viewItems.splice(index, 0, item);\n                this._actionIds.splice(index, 0, action.id);\n                index++;\n            }\n        });\n        if (typeof this.focusedItem === 'number') {\n            // After a clear actions might be re-added to simply toggle some actions. We should preserve focus #97128\n            this.focus(this.focusedItem);\n        }\n    }\n    clear() {\n        dispose(this.viewItems);\n        this.viewItems = [];\n        this._actionIds = [];\n        DOM.clearNode(this.actionsList);\n    }\n    length() {\n        return this.viewItems.length;\n    }\n    focus(arg) {\n        let selectFirst = false;\n        let index = undefined;\n        if (arg === undefined) {\n            selectFirst = true;\n        }\n        else if (typeof arg === 'number') {\n            index = arg;\n        }\n        else if (typeof arg === 'boolean') {\n            selectFirst = arg;\n        }\n        if (selectFirst && typeof this.focusedItem === 'undefined') {\n            const firstEnabled = this.viewItems.findIndex(item => item.isEnabled());\n            // Focus the first enabled item\n            this.focusedItem = firstEnabled === -1 ? undefined : firstEnabled;\n            this.updateFocus();\n        }\n        else {\n            if (index !== undefined) {\n                this.focusedItem = index;\n            }\n            this.updateFocus();\n        }\n    }\n    focusFirst() {\n        this.focusedItem = this.length() > 1 ? 1 : 0;\n        return this.focusPrevious();\n    }\n    focusLast() {\n        this.focusedItem = this.length() < 2 ? 0 : this.length() - 2;\n        return this.focusNext();\n    }\n    focusNext() {\n        if (typeof this.focusedItem === 'undefined') {\n            this.focusedItem = this.viewItems.length - 1;\n        }\n        else if (this.viewItems.length <= 1) {\n            return false;\n        }\n        const startIndex = this.focusedItem;\n        let item;\n        do {\n            if (this.options.preventLoopNavigation && this.focusedItem + 1 >= this.viewItems.length) {\n                this.focusedItem = startIndex;\n                return false;\n            }\n            this.focusedItem = (this.focusedItem + 1) % this.viewItems.length;\n            item = this.viewItems[this.focusedItem];\n        } while (this.focusedItem !== startIndex && this.options.focusOnlyEnabledItems && !item.isEnabled());\n        this.updateFocus();\n        return true;\n    }\n    focusPrevious() {\n        if (typeof this.focusedItem === 'undefined') {\n            this.focusedItem = 0;\n        }\n        else if (this.viewItems.length <= 1) {\n            return false;\n        }\n        const startIndex = this.focusedItem;\n        let item;\n        do {\n            this.focusedItem = this.focusedItem - 1;\n            if (this.focusedItem < 0) {\n                if (this.options.preventLoopNavigation) {\n                    this.focusedItem = startIndex;\n                    return false;\n                }\n                this.focusedItem = this.viewItems.length - 1;\n            }\n            item = this.viewItems[this.focusedItem];\n        } while (this.focusedItem !== startIndex && this.options.focusOnlyEnabledItems && !item.isEnabled());\n        this.updateFocus(true);\n        return true;\n    }\n    updateFocus(fromRight, preventScroll) {\n        if (typeof this.focusedItem === 'undefined') {\n            this.actionsList.focus({ preventScroll });\n        }\n        for (let i = 0; i < this.viewItems.length; i++) {\n            const item = this.viewItems[i];\n            const actionViewItem = item;\n            if (i === this.focusedItem) {\n                let focusItem = true;\n                if (!types.isFunction(actionViewItem.focus)) {\n                    focusItem = false;\n                }\n                if (this.options.focusOnlyEnabledItems && types.isFunction(item.isEnabled) && !item.isEnabled()) {\n                    focusItem = false;\n                }\n                if (focusItem) {\n                    actionViewItem.focus(fromRight);\n                }\n                else {\n                    this.actionsList.focus({ preventScroll });\n                }\n            }\n            else {\n                if (types.isFunction(actionViewItem.blur)) {\n                    actionViewItem.blur();\n                }\n            }\n        }\n    }\n    doTrigger(event) {\n        if (typeof this.focusedItem === 'undefined') {\n            return; //nothing to focus\n        }\n        // trigger action\n        const actionViewItem = this.viewItems[this.focusedItem];\n        if (actionViewItem instanceof BaseActionViewItem) {\n            const context = (actionViewItem._context === null || actionViewItem._context === undefined) ? event : actionViewItem._context;\n            this.run(actionViewItem._action, context);\n        }\n    }\n    run(action, context) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._actionRunner.run(action, context);\n        });\n    }\n    dispose() {\n        dispose(this.viewItems);\n        this.viewItems = [];\n        this._actionIds = [];\n        this.getContainer().remove();\n        super.dispose();\n    }\n}\n"]},"metadata":{},"sourceType":"module"}